GO		?= go

PWD		:= $(shell pwd)
GATEDIR		:= $(dir $(PWD))

include $(GATEDIR)/llvm.make

PASS_PLUGIN	:= $(GATEDIR)/llvmpass/build/libgatepass.so
LINK_SCRIPT	:= $(PWD)/link.ld
TEST_BITCODE	:= $(GATEDIR)/crt/test/prog.bc

nothing:

check:
	GATE_ASSEMBLE_TEST_OPT=$(OPT) GATE_ASSEMBLE_TEST_PASS_PLUGIN=$(PASS_PLUGIN) GATE_ASSEMBLE_TEST_LLC=$(LLC) GATE_ASSEMBLE_TEST_AS=$(AS) GATE_ASSEMBLE_TEST_LD=$(LD) GATE_ASSEMBLE_TEST_LINK_SCRIPT=$(LINK_SCRIPT) GATE_ASSEMBLE_TEST_BITCODE=$(TEST_BITCODE) $(GO) test -v .

.PHONY: nothing check
